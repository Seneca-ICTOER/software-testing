<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.9">
<link rel="icon" href="/img/pwa/icon-512x512.png">
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="#DA291C">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#DA291C">
<link rel="apple-touch-icon" href="/img/pwa/icon-192x192.png">
<link rel="mask-icon" href="/img/pwa/icon-512x512.png" color="#DA291C">
<meta name="msapplication-TileImage" content="/img/pwa/icon-512x512.png">
<meta name="msapplication-TileColor" content="#DA291C"><title data-react-helmet="true">Unit Testing in Visual Studio | Software Testing</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://software-testing.sdds.ca/C-UnitTesting/vs-test-2"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Unit Testing in Visual Studio | Software Testing"><meta data-react-helmet="true" name="description" content="TBD"><meta data-react-helmet="true" property="og:description" content="TBD"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://software-testing.sdds.ca/C-UnitTesting/vs-test-2"><link data-react-helmet="true" rel="alternate" href="https://software-testing.sdds.ca/C-UnitTesting/vs-test-2" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://software-testing.sdds.ca/C-UnitTesting/vs-test-2" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.5ebce48d.css">
<link rel="preload" href="/assets/js/runtime~main.ff06dc85.js" as="script">
<link rel="preload" href="/assets/js/main.f2fe67bb.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Seneca College" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/img/logo-dark.svg" alt="Seneca College" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">Software Testing</b></a></div><div class="navbar__items navbar__items--right"><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">🌜</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">🌞</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">Table of Contents</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Test Data Selection</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Unit Testing</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/C-UnitTesting/unit-testing-1">Unit Testing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/C-UnitTesting/vs-test-2">Unit Testing in Visual Studio</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/C-UnitTesting/testing-coverage-3">Testing Coverage</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Debugging</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Software Development Life Cycle</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Quality Assurance</a></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Unit Testing in Visual Studio</h1></header><p>Visual Studio provides its own test framework for C and C++ programs. The framework is written in C++, but can be adapted to test C code as well as C++ code. While the framework can be used to test any existing project, one of the common ways to use the test framework is to add the test code itself as a new project to the solution that is under test. We will look at testing the following code.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="mathfuncsh">mathfuncs.h<a aria-hidden="true" class="hash-link" href="#mathfuncsh" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI C"><pre tabindex="0" class="prism-code language-C codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">#pragma once</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#ifndef MATHFUNCS_H</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#define MATHFUNCS_H</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">double square(double n);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">double cube(double n);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#endif</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="mathfuncsc">mathfuncs.c<a aria-hidden="true" class="hash-link" href="#mathfuncsc" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI C"><pre tabindex="0" class="prism-code language-C codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">#include &quot;mathfuncs.h&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">double square(double n)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return n * n;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">double cube(double n)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return n * n * n;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>As you can see, we create two functions: one to square a number and another to cube a number. Testing that these functions work is a simple matter but seeing how it is done will illustrate all the steps in creating a test project for an existing project.</p><p>Open the project you want to test and then click on the name of the solution at the top of the solution explorer. Then, from the File menu select New | Project. This will display the new project menu and you should select a native unit test project for C++ on Windows, as shown below.</p><p><img alt="&amp;quot;Dialog to create a unit testing project in Visual Studio&amp;quot; " src="/assets/images/vs-create-unit-project-f845770b53cb17423f81819f61b8659f.jpg"></p><p>Once the project has been created, you will see it at the bottom of the solution explorer. They have already written a skeleton unit test program for you called UnitTest1.cpp (or whatever name you selected). I have modified this file to look as shown below.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI C"><pre tabindex="0" class="prism-code language-C codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">#include &quot;pch.h&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#include &quot;CppUnitTest.h&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#include &quot;mathfuncs_r.h&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using namespace Microsoft::VisualStudio::CppUnitTestFramework;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">namespace MathTestSuite</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    TEST_CLASS(MathTest)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        TEST_METHOD(SquareTest)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            double d = square(8.0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Assert::AreEqual(64.0, d);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        TEST_METHOD(CubeTest)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            double d = cube(3.0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Assert::AreEqual(27.0, d);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    TEST_CLASS(MathIntegrationTest)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        TEST_METHOD(AdditionTest)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            double d = square(8.0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            double d1 = cube(3.0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Assert::AreEqual(91.0, d + d1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>I modified the namespace to be more meaningful and called it <strong>MathTestSuite</strong>. Within the namespace, I have created two classes. Each class would usually represent the tests for a single function or feature. Placing tests in classes provides a convenient way to group tests together. Inside each class, there are test methods which each test one particular aspect of the code. In this example, I have one class to test the functions and a second class to test how the functions might work together. There is no set way to do this and you are encouraged to layout your tests in the most organized fashion you can for your particular project.</p><p>Inside the tests, you call your functions with specific values and then use an assertion to determine if the result is correct by comparing it to a known value. The Assert class has many methods that allow you to compare values. If the two values pass the comparison, the test passes, otherwise it fails.</p><p>The methods of the Assert class are summarized in the following table.</p><table><thead><tr><th align="left">Method</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left">AreEqual(v1, v2 <!-- -->[, &quot;error message&quot;]<!-- --> )</td><td align="left">Compares v1 to v2 and throws an exception if they are not equal. If they are not equal, the optional error string will be displayed.</td></tr><tr><td align="left">AreNotEqual(v1, v2 <!-- -->[, &quot;error message&quot;]<!-- --> )</td><td align="left">Compares v1 to v2 and throws an exception if they are equal. If they are equal, the optional error string will be displayed.</td></tr><tr><td align="left">IsTrue(b1 <!-- -->[, &quot;error message&quot;]<!-- --> )</td><td align="left">If the Boolean b1 is not true it throws an exception. If not true, the optional error string will be displayed.</td></tr><tr><td align="left">IsFalse(b1 <!-- -->[, &quot;error message&quot;]<!-- --> )</td><td align="left">If the Boolean b1 is not false it throws an exception. If not false, the optional error string will be displayed.</td></tr><tr><td align="left">Fail(<!-- -->[ &quot;error message&quot;]<!-- --> )</td><td align="left">This causes the test to fail and throws an exception. If called, the optional error string will be displayed.</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_y2LR" id="accessing-the-software-under-test">Accessing the Software Under Test<a aria-hidden="true" class="hash-link" href="#accessing-the-software-under-test" title="Direct link to heading">​</a></h2><p>We have now created two projects in the same solution. The testing project needs access to:</p><ul><li>the .lib or .obj file for the software under test,</li><li>the header files for the project or modified header files if the project is in pure C.</li></ul><p>To make the project we are testing visible to the test code, we need to modify the values of the properties of the test project. You can do this by right clicking on the test project in the solution explorer and selecting properties. Once the properties are displayed, select <strong>Linker | General</strong> and then <strong>Additional Library Directories</strong>. This will display the dialog shown below.</p><p><img alt="&amp;quot;Dialog to set additional library directories.&amp;quot; " src="/assets/images/vs-add-lib-dirs-cd8522e8535a68e765f2655a1943d5d1.jpg"></p><p>The goal is to add the debug directory in the project under test. This should be two levels higher in the directory structure and then into the project under test. Start by clicking the symbol for a new directory at the left of the top series of buttons. This will create a new row into which you can type the directory. While you can use the threee dots to navigate, this will result in an absolute path which will make it difficult to move the project to a different location. A better way is to use the macro <strong>$(ProjectDir)</strong> which will be set to the directory containing the source code for the test project. If the project is moved, this macro will be automatically updated.</p><p>Next, we need to provide the name of the file(s) containing the compiled version of the software under test. If you just have an object file, like we do here, then you can just enter the name, <strong>mathfuncs.obj</strong>. If you had build a library, then you would enter the name of the library.</p><p>The final step is to tell the test project how to find the header files for the project being tested. If this is a C++ project we are testing then we navigate to <strong>C/C++ | General | Additional Include Directories</strong> and add the include directory for the project under test. If the project you are testing is pure C, then the process is more complicated.</p><p>C++ compilers alter names of functions inside classes so that they can determine the class that a particular method belongs to. C compilers do not do this, and this creates a problem when we are trying to link C++ code with pure C code. In order to get the two language is to be compiled together, we have to tell the C++ compiler which functions are actually pure C so that it will not alter the names of them, but just use the original names. The way we can do this, is to use the <strong>extern “C”</strong> declaration as demonstrated in the next piece of code.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI c"><pre tabindex="0" class="prism-code language-c codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">pragma</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property expression" style="color:#36acaa">once</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">ifndef</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property expression" style="color:#36acaa">MATHFUNCS_R_H</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">define</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property macro-name" style="color:#36acaa">MATHFUNCS_R_H</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">extern</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;C&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;mathfuncs.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">endif</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>What I have done in this piece of code is to include the header file for the software under test inside an <strong>extern “C”</strong> block. This prevents the C compiler from altering the names and allows the two languages to be linked together. I called this file <strong>mathfuncs_r.h</strong> and placed it in the test project. The <strong>_<!-- -->r</strong> is used to indicate it references the original header file. Next, you need to tell the test project where to find the header files for the project under test. This is done by editing the test project properties under <strong>C++ | General | Additional Include Directories</strong>. You should add paths to include the directories in which the header files are stored for the code you are testing, as well as the test project. Once done, the include paths should look like:</p><p><img alt="&amp;quot;Visual Studio Test Include Path&amp;quot; " src="/assets/images/vs-test-include-0c8d6b5f1137ce798f90f6fbb5c72426.jpg"></p><p>The final step is to go the <strong>Build</strong> menu at the top and select <!-- -->*<!-- -->Build All<!-- -->*<!-- -->*<!-- --> . You should ckeck the output window at the bottom to be sure that the solution compiled correctly. It should say that two projects were compiled and zero failed.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="running-the-tests">Running the Tests<a aria-hidden="true" class="hash-link" href="#running-the-tests" title="Direct link to heading">​</a></h2><p>The next step is to actually run the tests. Go to the <strong>Test</strong> menu at the top and select <strong>Test Explorer</strong>. This will display a new window to control the tests, as shown below. This wildow can be left floating or docked into the Visual Studio window.</p><p><img alt="&amp;quot;Visual Studio Test Explorer&amp;quot; " src="/assets/images/vs-test-explorer-4ba01e6cf047a602a2e5f0ae5418391f.jpg"></p><p>The Test Explorer shows:</p><ul><li>the list of tests,</li><li>controls to run the tests,</li><li>the number of tests available to run, the number passed, the number failed, and the number which have not been run,</li><li>a sub-window at the right that will show the output of the tests.</li></ul><p>With the test explorer, you can highlight the test(s) you want to run and then press the <em>play</em> button to run the tests. The results of the test are shown as you can see in the diagram below.</p><p><img alt="&amp;quot;Visual Studio Test Explorer showing results of a test.&amp;quot; " src="/assets/images/vs-test-explorer-results-26a9fce28b92ec1ad494ce59cee5a32f.jpg"></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="setting-up-and-tearing-down-tests">Setting Up and Tearing Down Tests<a aria-hidden="true" class="hash-link" href="#setting-up-and-tearing-down-tests" title="Direct link to heading">​</a></h2><p>You can create additional functions to set up and tear down the tests. This would be needed if you required data structures to be set up before the tests were run and torn down after the tests were completed. There are functions for <strong>TEST_MODULE_INITIALIZE</strong> and <strong>TEST_MODULE_CLEANUP</strong> which are run before any of the class tests are run and after all class tests are complete. In addition, there are methods to go inside a test class called <strong>TEST_CLASS_INITIALIZE</strong> and <strong>TEST_CLASS_CLEANUP</strong>. These can be used to setup and tear down data structures required for each test class. There is a <strong>Logger</strong> class which is used to write simple messages to the test output. This is demonstrated in the code below:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI c"><pre tabindex="0" class="prism-code language-c codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&quot;pch.h&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&quot;CppUnitTest.h&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&quot;mathfuncs_r.h&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using namespace Microsoft</span><span class="token operator" style="color:#393A34">::</span><span class="token plain">VisualStudio</span><span class="token operator" style="color:#393A34">::</span><span class="token plain">CppUnitTestFramework</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">namespace MathTestSuite</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">TEST_MODULE_INITIALIZE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ModuleInitialize</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Logger</span><span class="token operator" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">WriteMessage</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;In Module Initialize&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">TEST_MODULE_CLEANUP</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ModuleCleanup</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Logger</span><span class="token operator" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">WriteMessage</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;In Module Cleanup&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">TEST_CLASS</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">MathTest</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">TEST_CLASS_INITIALIZE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ClassInitialize</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Logger</span><span class="token operator" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">WriteMessage</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;In Class Initialize&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">TEST_CLASS_CLEANUP</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ClassCleanup</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Logger</span><span class="token operator" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">WriteMessage</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;In Class Cleanup&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">TEST_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">SquareTest</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Logger</span><span class="token operator" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">WriteMessage</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;In Square test&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">double</span><span class="token plain"> d </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">square</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">8.0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Assert</span><span class="token operator" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">AreEqual</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">64.0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> d</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">TEST_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">CubeTest</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Logger</span><span class="token operator" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">WriteMessage</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;In Cube test&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">double</span><span class="token plain"> d </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">cube</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">3.0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Assert</span><span class="token operator" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">AreEqual</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">27.0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> d</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">TEST_CLASS</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">MathIntegrationTest</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">TEST_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">AdditionTest</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">double</span><span class="token plain"> d </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">square</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">8.0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">double</span><span class="token plain"> d1 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">cube</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">3.0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Logger</span><span class="token operator" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">WriteMessage</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;In Integration test&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Assert</span><span class="token operator" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">AreEqual</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">91.0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> d </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> d1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>We can run this code using the command <code>vstest.console.exe UnitTest1.dll</code>. This command should be executed in a Windows cmd shell and will produce the output shown below. Note the order in which the initialize and cleanup functions are run.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">vstest.console.exe UnitTest1.dll</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Microsoft (R) Test Execution Command Line Tool Version 16.11.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Copyright (c) Microsoft Corporation.  All rights reserved.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Starting test execution, please wait...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">A total of 1 test files matched the specified pattern.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">In Module Initialize</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">In Integration test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">In Class Initialize</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">In Square test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">In Cube test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">In Class Cleanup</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">In Module Cleanup</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Passed AdditionTest [&lt; 1 ms]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Passed SquareTest [&lt; 1 ms]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Passed CubeTest [&lt; 1 ms]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Test Run Successful.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Total tests: 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     Passed: 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> Total time: 0.2394 Seconds</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/Seneca-ICTOER/software-testing/tree/main/docs/C-UnitTesting/vs-unit-2.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/C-UnitTesting/unit-testing-1"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« <!-- -->Unit Testing</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/C-UnitTesting/testing-coverage-3"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Testing Coverage<!-- --> »</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#mathfuncsh" class="table-of-contents__link toc-highlight">mathfuncs.h</a></li><li><a href="#mathfuncsc" class="table-of-contents__link toc-highlight">mathfuncs.c</a></li><li><a href="#accessing-the-software-under-test" class="table-of-contents__link toc-highlight">Accessing the Software Under Test</a></li><li><a href="#running-the-tests" class="table-of-contents__link toc-highlight">Running the Tests</a></li><li><a href="#setting-up-and-tearing-down-tests" class="table-of-contents__link toc-highlight">Setting Up and Tearing Down Tests</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Software Testing</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/">Contents</a></li><li class="footer__item"><a href="#" id="pwa-button" class="footer__link-item" hidden>Install as an App</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 Seneca College.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.ff06dc85.js"></script>
<script src="/assets/js/main.f2fe67bb.js"></script>
</body>
</html>